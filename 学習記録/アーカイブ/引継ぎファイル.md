# MERN スタック TODO アプリ開発 - 引継ぎファイル

## プロジェクトの現状

MERN スタック（MongoDB, Express, React, Node.js）を使用した TODO アプリケーションの基本機能がすべて完成し、デプロイ準備も完了しています。

### 完了したこと

1.  **フロントエンド (React)**:

    - TODO の表示、追加、完了状態の切り替え、削除を行う UI を`client/src/App.jsx`に実装済み。
    - `axios`を使用してバックエンド API との通信を実装済み。
    - 本番環境向けに API の URL を相対パス (`/todos`) に修正済み。

2.  **バックエンド (Express/Node.js)**:

    - TODO の CRUD 操作（作成、読み取り、更新、削除）に対応する API エンドポイントを`server/routes/todos.js`に実装済み。
    - `async/await`を使用して、可読性の高いコードにリファクタリング済み。
    - 本番環境で React のビルド済みファイルを提供するための設定を`server/server.js`に追加済み。

3.  **データベース (MongoDB)**:

    - MongoDB Atlas でデータベースを作成し、`server/.env`ファイルに接続文字列を設定済み。

4.  **ソースコード管理とデプロイ準備**:
    - プロジェクト全体を`mern-todo-app`という名前で Git 管理し、公開（Public）リポジトリとして GitHub に発行済み。
    - デプロイ先として`Render.com`を選定。

---

## 次のステップ: Render.com へのデプロイ

現在の作業は、**Render.com で Web サービスを作成し、デプロイ設定を行う**段階です。

### 手順

1.  **Render にログイン**し、ダッシュボードで「**New +**」 > 「**Web Service**」を選択します。

2.  GitHub リポジトリの一覧から、`mern-todo-app`リポジトリを選択して「**Connect**」をクリックします。

3.  以下の通りに**デプロイ設定**を行います。

    - **Name**: `mern-todo-app` （またはお好きな名前）
    - **Root Directory**: `server`
    - **Build Command**:
      ```bash
      npm install && cd ../client && npm install && npm run build
      ```
    - **Start Command**: `node server.js`
    - **Plan**: `Free`

4.  「**Advanced**」セクションを開き、**環境変数**を 2 つ追加します。

    - **1 つ目:**

      - **Key**: `ATLAS_URI`
      - **Value**: `server/.env`ファイルに記載されている MongoDB の接続文字列を貼り付けます。

      ```
      mongodb+srv://toritakegm_db_user:toritake20250926@telpcampcluster.f2x83eh.mongodb.net/telp-camp?retryWrites=true&w=majority&appName=TelpCampCluster
      ```

    - **2 つ目:**
      - **Key**: `NODE_ENV`
      - **Value**: `production`

5.  「**Create Web Service**」ボタンをクリックしてデプロイを開始します。

---

## プロジェクトの主要ファイル

### `client/src/App.jsx`

```javascript
import { useState, useEffect } from "react";
import axios from "axios";

const API_URL = "/todos";

function App() {
  // (関数の実装は省略)
}
export default App;
```

### `server/server.js`

```javascript
const express = require("express");
const cors = require("cors");
const mongoose = require("mongoose");
const path = require("path");

require("dotenv").config();

const app = express();
const port = process.env.PORT || 5000;

app.use(cors());
app.use(express.json());

const uri = process.env.ATLAS_URI;
mongoose.connect(uri);
const connection = mongoose.connection;
connection.once("open", () => {
  console.log("MongoDB データベースへの接続が正常に確立されました");
});

const todosRouter = require("./routes/todos");
app.use("/todos", todosRouter);

if (process.env.NODE_ENV === "production") {
  app.use(express.static(path.join(__dirname, "../client/dist")));
  app.get("*", (req, res) => {
    res.sendFile(path.resolve(__dirname, "../client/dist", "index.html"));
  });
}

app.listen(port, () => {
  console.log(`サーバーがポート ${port} で起動しました。`);
});
```

### `server/routes/todos.js`

```javascript
const router = require("express").Router();
let Todo = require("../models/todo.model");

// GET /
// POST /
// PATCH /:id
// DELETE /:id
// (各エンドポイントの実装は省略)

module.exports = router;
```
